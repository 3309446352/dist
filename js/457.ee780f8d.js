"use strict";(self["webpackChunkrx"]=self["webpackChunkrx"]||[]).push([[457],{7883:function(t,e,a){a.d(e,{Z:function(){return l}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"bg-box"},[e("div",{staticClass:"bg"}),e("div",{staticClass:"bg-content"}),t._t("default")],2)},n=[],o={name:"BgBox"},i=o,c=a(1001),r=(0,c.Z)(i,s,n,!1,null,"eec436ba",null),l=r.exports},8457:function(t,e,a){a.r(e),a.d(e,{default:function(){return u}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"account"},[e("van-nav-bar",{attrs:{title:"个人资料","left-text":"返回","left-arrow":""},on:{"click-left":t.onClickLeft}}),e("BgBox",[e("div",{staticClass:"conf"},[e("van-cell",{attrs:{title:"头像",center:!0}},[e("div",[e("div",{staticClass:"user-img fr"},[e("img",{attrs:{src:t.accountInfo.userImg,alt:""}}),e("van-uploader",{staticClass:"upload-box",attrs:{"after-read":t.uploadUserImg}})],1)])]),e("van-cell",{attrs:{title:"用户id",center:!0}},[t._v(t._s(t.accountInfo.userId))]),e("van-cell",{attrs:{title:"手机号",center:!0}},[t._v(t._s(t.accountInfo.phone))]),e("van-cell",{attrs:{title:"昵称",center:!0}},[e("van-field",{staticClass:"field-box",attrs:{"label-width":"5",maxlength:"12",placeholder:"输入昵称","input-align":"right"},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.updateNickName.apply(null,arguments)}},model:{value:t.accountInfo.nickName,callback:function(e){t.$set(t.accountInfo,"nickName",e)},expression:"accountInfo.nickName"}})],1),e("div",{staticClass:"desc-box"},[e("div",{staticClass:"desc-content"},[e("van-field",{attrs:{row:"2",autosize:"",label:"简介",type:"textarea",maxlength:"30",placeholder:"输入简介","show-word-limit":"","input-align":"right"},on:{change:t.updateDesc},model:{value:t.accountInfo.desc,callback:function(e){t.$set(t.accountInfo,"desc",e)},expression:"accountInfo.desc"}})],1)])],1)])],1)},n=[],o=a(7883),i={name:"Account",components:{BgBox:o.Z},setup(){const t=()=>history.back();return{onClickLeft:t}},data(){return{accountInfo:{nickName:"",desc:"",phone:"",userId:""}}},created(){this.getAccountInfo()},methods:{getAccountInfo(){let t=localStorage.getItem("token");if(!t)return this.$toast("请先登录"),this.$router.push({name:"Login"});this.$toast.loading({message:"加载中……",forbidClick:!0,duration:0}),this.axios({method:"GET",url:"/findAccountInfo",params:{appkey:this.appkey,tokenString:t}}).then((t=>{if(this.$toast.clear(),console.log(t),700==t.data.code)this.$router.push({name:"Login"});else if("B001"==t.data.code){let e=t.data.result[0];""==e.desc&&(e.desc="这家伙很懒，什么都没留下"),this.accountInfo=e}})).catch((t=>{this.$toast.clear()}))},uploadUserImg(t){let e=["gif","png","jpg","jpeg"],a=1,s=t.file.type.split("/")[1];if(-1===e.indexOf(s))return void this.$toast(`文件类型只支持${e.join(",")}`);let n=t.file.size/1024/1024;if(n>a)return void this.$toast(`文件允许最大不能超过${a}MB`);let o=t.content.replace(/^data:image\/[A-Za-z]+;base64,/,""),i=localStorage.getItem("token");if(!i)return this.$toast("请先登录"),this.$router.push({name:"Login"});this.$toast.loading({message:"加载中……",forbidClick:!0,duration:0}),this.axios({method:"POST",url:"/updateAvatar",data:{appkey:this.appkey,tokenString:i,imgType:s,serverBase64Img:o}}).then((t=>{this.$toast.clear(),700==t.data.code?this.$router.push({name:"Login"}):"H001"==t.data.code&&(this.accountInfo.userImg=t.data.userImg),this.$toast(t.data.msg)})).catch((t=>{this.$toast.clear()}))},updateNickName(){this.accountInfo.nickName||this.$toast("昵称不能为空");let t=localStorage.getItem("token");if(!t)return this.$toast("请先登录"),this.$router.push({name:"Login"});this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0}),this.axios({method:"POST",url:"/updateNickName",data:{appkey:this.appkey,tokenString:t,nickName:this.accountInfo.nickName}}).then((t=>{this.$toast.clear(),700==t.data.code?this.$router.push({name:"Login"}):this.$toast(t.data.msg)})).catch((t=>{this.$toast.clear()}))},updateDesc(){this.accountInfo.nickname||this.$toast("昵称不能为空");let t=localStorage.getItem("token");if(!t)return this.$toast("请向登录"),this.$router.push({name:"Login"});this.$toast.loading({message:"加载中……",forbidClick:!0,duration:0}),this.axios({method:"POST",url:"/updateDesc",data:{appkey:this.appkey,tokenString:t,desc:this.accountInfo.desc}}).then((t=>{this.$toast.clear(),700==t.data.code?this.$router.push({name:"Login"}):this.$toast(t.data.msg)})).catch((t=>{this.$toast.clear()}))}}},c=i,r=a(1001),l=(0,r.Z)(c,s,n,!1,null,"5cd04a5f",null),u=l.exports}}]);
//# sourceMappingURL=457.ee780f8d.js.map