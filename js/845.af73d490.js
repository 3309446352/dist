"use strict";(self["webpackChunkrx"]=self["webpackChunkrx"]||[]).push([[845],{7883:function(t,s,o){o.d(s,{Z:function(){return c}});var e=function(){var t=this,s=t._self._c;return s("div",{staticClass:"bg-box"},[s("div",{staticClass:"bg"}),s("div",{staticClass:"bg-content"}),t._t("default")],2)},a=[],r={name:"BgBox"},i=r,n=o(1001),l=(0,n.Z)(i,e,a,!1,null,"eec436ba",null),c=l.exports},4845:function(t,s,o){o.r(s),o.d(s,{default:function(){return d}});var e=function(){var t=this,s=t._self._c;return s("div",{},[s("van-nav-bar",{attrs:{title:"安全中心","left-text":"返回","left-arrow":""},on:{"click-left":t.onClickLeft}}),s("BgBox",[s("div",{staticClass:"conf"},[s("van-cell",[s("van-cell",{attrs:{"is-link":""},on:{click:t.showPopup}},[t._v("修改密码")]),s("van-popup",{style:{height:"40%"},attrs:{position:"bottom"},model:{value:t.show,callback:function(s){t.show=s},expression:"show"}},[s("van-form",{staticClass:"Signup"},[s("p",[t._v("修改密码")]),s("van-field",{attrs:{type:"OldPassword",name:"password",label:"旧密码",placeholder:"旧密码(6-16)位",rules:[{required:!0,message:"旧请填写密码"}]},model:{value:t.oldPassword,callback:function(s){t.oldPassword=s},expression:"oldPassword"}}),s("van-field",{attrs:{type:"Password",name:"password",label:"新密码",placeholder:"密码(6-16)位",rules:[{required:!0,message:"请新填写密码"}]},model:{value:t.Password,callback:function(s){t.Password=s},expression:"Password"}}),s("div",{staticClass:"SignupT",on:{click:t.updatePassword}},[t._v("确认修改")])],1)],1)],1),s("van-cell",[s("van-cell",{attrs:{"is-link":""},on:{click:t.showPopupt}},[t._v("注销账号")])],1),s("br"),s("br"),s("br"),s("div",{staticStyle:{margin:"16px",bottom:"0%"}},[s("van-button",{attrs:{round:"",block:"",color:"rgb(13, 0, 255)",type:"info","native-type":"submit"},on:{click:t.tologin}},[t._v(" 退出登录")])],1)],1)])],1)},a=[],r=o(4605),i=o(7883),n={components:{BgBox:i.Z},setup(){const t=()=>history.back();return{onClickLeft:t}},data(){return{show:!1,showt:!1,oldPassword:"",Password:""}},methods:{showPopup(){this.show=!0},showPopupt(){this.$dialog.confirm({title:"注销账号",message:"是否确认注销账号,一旦确认无法恢复"}).then((()=>{this.godestroyAccount()})).catch((t=>{}))},updatePassword(){let t={phone:{value:this.oldpassword,errorMsg:"j旧密码由数字字母下划线组合(6-16字符)",reg:/^[A-ZA-z]\w{5,15}$/},password:{value:this.password,errorMsg:"密码由数字字母下划线组合(6-16字符)",reg:/^[A-ZA-z]\w{5,15}$/}},s=r.$.valid(t);if(s){if(this.oldPassword==this.Password)return void this.$toast("新密码和旧密码不能相同");let t=localStorage.getItem("token");if(!t)return this.$toast("请先登录"),this.$router.push({name:"Login"});this.$toast.loading({message:"加载中……",forbidClick:!0,duration:0}),this.axios({method:"POST",url:"/updatePassword",data:{appkey:this.appkey,tokenString:t,password:this.Password,oldPassword:this.oldPassword}}).then((t=>{this.$toast(t.data.msg)})).catch((t=>{this.$toast.clear()}))}},godestroyAccount(){let t=localStorage.getItem("token");if(!t)return this.$toast("请先登录"),this.$router.push({name:"Login"});this.$toast.loading({message:"加载中……",forbidClick:!0,duration:0}),this.axios({method:"POST",url:"/destroyAccount",params:{appkey:this.appkey,tokenString:t}}).then((t=>(this.$toast.clear(),localStorage.removeItem("token"),this.$router.push({name:"Login"})))).catch((t=>{this.$toast.clear()}))},tologin(){this.$dialog.confirm({title:"退出登录",message:"是否确认退出登录"}).then((()=>{this.gologout()})).catch((t=>{}))},gologout(){let t=localStorage.getItem("token");if(!t)return this.$toast("请先登录"),this.$router.push({name:"Login"});this.$toast.loading({message:"加载中……",forbidClick:!0,duration:0}),this.axios({method:"POST",url:"/logout",params:{appkey:this.appkey,tokenString:t}}).then((t=>{this.$toast.clear(),this.$router.push({name:"Login"}),700==t.data.code?this.$router.push({name:"Login"}):"G001"==t.data.code&&setTimeout((()=>{localStorage.removeItem("token"),this.$router.push({name:"Login"})}),800),console.log(t)})).catch((t=>{this.$toast.clear()}))}}},l=n,c=o(1001),u=(0,c.Z)(l,e,a,!1,null,"c4b8ebaa",null),d=u.exports},4605:function(t,s,o){o.d(s,{$:function(){return i}});o(6743);var e=o(8848),a=o(6369);a["default"].use(e.Z);class r{constructor(){}valid(t){for(let s in t)if(!t[s].reg.test(t[s].value))return(0,e.Z)(t[s].errorMsg),!1;return!0}}const i=new r}}]);
//# sourceMappingURL=845.af73d490.js.map