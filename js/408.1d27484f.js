"use strict";(self["webpackChunkrx"]=self["webpackChunkrx"]||[]).push([[408],{7883:function(t,e,a){a.d(e,{Z:function(){return c}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"bg-box"},[e("div",{staticClass:"bg"}),e("div",{staticClass:"bg-content"}),t._t("default")],2)},s=[],r={name:"BgBox"},o=r,l=a(1001),n=(0,l.Z)(o,i,s,!1,null,"eec436ba",null),c=n.exports},9569:function(t,e,a){a.d(e,{Z:function(){return c}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"order-item"},[e("div",{staticClass:"cell-item-box"},[e("div",{staticClass:"pro-info-box"},[e("div",{staticClass:"pro-img"},[e("img",{staticClass:"auto-img",attrs:{src:t.item.small_img||t.item.smallImg,alt:""}})]),e("div",{staticClass:"pro-info fl"},[e("div",{staticClass:"pro-info-text"},[e("div",{staticClass:"names clearfix"},[e("div",{staticClass:"pro-name"},[t._v(t._s(t.item.name))]),e("div",{staticClass:"pro-rule"},[t._v(t._s(t.item.rule))])]),e("div",{staticClass:"pro-enname"},[t._v(t._s(t.item.enname))])]),e("div",{staticClass:"pro-count-box"},[e("div",{staticClass:"pro-price fl"},[t._v("￥"+t._s(t.item.price))]),e("div",{staticClass:"pro-count"},[t._v("X"+t._s(t.item.count))])])])])]),e("br")])},s=[],r={name:"OrderItem",props:{item:{type:Object,default(){return{name:"名称",rule:"规格",enname:"英文名称",prico:0,count:1}}}}},o=r,l=a(1001),n=(0,l.Z)(o,i,s,!1,null,"45b09ce7",null),c=n.exports},7020:function(t,e,a){a.d(e,{Z:function(){return c}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"order-list"},[e("div",{staticClass:"pro-box"},[e("div",{staticClass:"info-boxs clearfix"},[e("div",{staticClass:"info-title fl"},[t._v(t._s(t.infoTitleLeft))]),e("br"),e("br"),t.isRight?e("div",{staticClass:"re-info fl"},[t.isReceive?e("div",{staticClass:"clearfix"},[e("div",{staticClass:"fl"},[t._v("已完成")]),e("div",{staticClass:"fl delete",on:{click:t.remove}},[e("van-icon",{attrs:{name:"delete",size:"20"}})],1)]):e("div",{staticClass:"conf",on:{click:t.confirmReceive}},[t._v("确认收货")])]):t._e()]),e("div",[e("div",{staticClass:"cell-list"},[t._t("default")],2),e("div",{staticClass:"bottom-into"},[t._m(0),""!=t.date?e("div",{staticClass:"date"},[t._v(t._s(t.date))]):t._e(),e("div",{staticClass:"clearfix"},[e("div",{staticClass:"fl",staticStyle:{display:"block"}},[t._v("共计"+t._s(t.count)+"件商品")]),e("div",{staticClass:"fl total",staticStyle:{display:"block"}},[t._v("订单金额￥"+t._s(t.total))])])])])])])},s=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"circle"},[e("div",{staticClass:"fl circle-box circle-left"}),e("div",{staticClass:"fr circle-box circle-right"})])}],r={name:"OrderList",props:{infoTitleLeft:{type:String,default:"左边标题"},isRight:{type:Boolean,default:!1},date:{type:String,default:"1970-01-01 00:00:00"},count:{type:Number,default:0},total:{type:[Number,String],default:0},isReceive:{type:Boolean,default:!1}},methods:{confirmReceive(){this.$emit("confirm-receive")},remove(){this.$emit("remove")}}},o=r,l=a(1001),n=(0,l.Z)(o,i,s,!1,null,"3c809507",null),c=n.exports},8055:function(t,e,a){a.r(e),a.d(e,{default:function(){return v}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"order"},[e("van-nav-bar",{attrs:{title:"我的订单","left-text":"返回","left-arrow":"",fixed:""},on:{"click-left":t.back}}),e("BgBox",[e("van-tabs",{attrs:{color:"#1a73e8","title-active-color":"#1a73e8","line-height":"2"},on:{change:t.changeTab},model:{value:t.tabIndex,callback:function(e){t.tabIndex=e},expression:"tabIndex"}},t._l(t.tabData,(function(a,i){return e("van-tab",{key:i,attrs:{title:a.title}},[t.orderData.length>0?e("div",t._l(t.orderData,(function(a,i){return e("div",{key:a.oid,staticClass:"order-box"},[e("OrderList",{attrs:{"info-title-left":a.oid,date:t._f("formatDate")(a.date,"yyyy-MM-dd hh:mm:ss"),count:a.count,total:t._f("decimal")(a.total),"is-right":!0,"is-receive":2==a.status},on:{"confirm-receive":function(e){return t.confirmReceive(a,i)},remove:function(e){return t.removeOrder(a.oid,i)}}},[t._l(a.data,(function(t,a){return e("OrderItem",{key:a,attrs:{item:t}})})),e("p",[t._v("哈哈哈哈")])],2)],1)})),0):e("div",[e("van-empty",{attrs:{description:"泥沙啊，膜的订单"}})],1)])})),1)],1)],1)},s=[],r=a(7883),o=a(7020),l=a(9569),n={name:"Order",components:{BgBox:r.Z,OrderList:o.Z,OrderItem:l.Z},data(){return{test:"2020-02-12T06:09:25.000Z",tabIndex:0,tabData:[{title:"全部"},{title:"进行中"},{title:"已完成"}],orderData:[],isHas:!0}},created(){this.getOrderDataByStatus()},methods:{back(){this.$router.go(-1)},changeTab(t,e){this.getOrderDataByStatus()},getOrderDataByStatus(){let t=localStorage.getItem("token");if(!t)return this.$toast("请先登录"),void this.$router.push({name:"Login"});this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0}),this.axios({method:"GET",url:"/findOrder",params:{appkey:this.appkey,tokenString:t,status:this.tabIndex}}).then((t=>{if(this.$toast.clear(),700==t.data.code)this.$router.push({name:"Login"});else if(7e4==t.data.code){if(0==this.tabIndex&&0==t.data.result.length)return void(this.isHas=!1);let e=[];t.data.result.map((t=>{for(let i=0;i<e.length;i++)if(e[i].oid==t.oid)return e[i].data.push(t),e[i].count+=t.count,void(e[i].total+=t.count*t.price);let a={};a.oid=t.oid,a.count=t.count,a.total=t.count*t.price,a.status=t.status,a.date=t.createdAt,a.data=[t],e.push(a)})),this.orderData=e}})).catch((t=>{this.$toast.clear()}))},confirmReceive(t,e){let a=localStorage.getItem("token");if(!a)return this.$toast("请先登录"),void this.$router.push({name:"Login"});this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0}),this.axios({method:"POST",url:"/receive",data:{appkey:this.appkey,tokenString:a,oid:t.oid}}).then((a=>{this.$toast.clear(),700==a.data.code?this.$router.push({name:"Login"}):8e4==a.data.code&&(1==this.tabIndex&&this.orderData.splice(e,1),t.status=2),this.$toast(a.data.msg)})).catch((t=>{this.$toast.clear()}))},removeOrder(t,e){let a=localStorage.getItem("token");if(!a)return this.$toast("请先登录"),void this.$router.push({name:"Login"});this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0}),this.axios({method:"POST",url:"/removeOrder",data:{appkey:this.appkey,tokenString:a,oid:t}}).then((t=>{this.$toast.clear(),700==t.data.code?this.$router.push({name:"Login"}):9e4==t.data.code&&this.orderData.splice(e,1),this.$toast(t.data.msg)})).catch((t=>{this.$toast.clear()}))}}},c=n,d=a(1001),u=(0,d.Z)(c,i,s,!1,null,null,null),v=u.exports}}]);
//# sourceMappingURL=408.1d27484f.js.map