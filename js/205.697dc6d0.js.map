{"version":3,"file":"js/205.697dc6d0.js","mappings":"gJAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACE,YAAY,MAAM,CAAEJ,EAAIK,SAASC,OAAQJ,EAAG,MAAM,CAACE,YAAY,QAAQG,MAAO,CAACC,gBAAiB,QAAOR,EAAIK,SAASC,aAAc,CAACJ,EAAG,eAAe,CAACE,YAAY,aAAaK,YAAY,CAAC,MAAQ,OAAO,OAAS,QAAQ,MAAQ,QAAQC,MAAM,CAAC,aAAaV,EAAIW,aAAa,GAAGX,EAAIY,KAAKV,EAAG,MAAM,CAACE,YAAY,WAAW,CAACF,EAAG,MAAM,CAACE,YAAY,YAAY,CAACF,EAAG,MAAM,CAACE,YAAY,aAAa,CAAEJ,EAAIK,SAASC,OAAQJ,EAAG,MAAM,CAACE,YAAY,WAAWM,MAAM,CAAC,IAAMV,EAAIK,SAASQ,QAAQ,IAAM,MAAMb,EAAIY,OAAOV,EAAG,MAAM,CAACE,YAAY,kBAAkB,CAACF,EAAG,MAAM,CAACE,YAAY,aAAa,CAACJ,EAAIc,GAAGd,EAAIe,GAAGf,EAAIK,SAASW,aAAad,EAAG,MAAM,CAACE,YAAY,aAAa,CAACJ,EAAIc,GAAGd,EAAIe,GAAwB,IAArBf,EAAIK,SAASY,KAAa,eAAgBjB,EAAIK,SAASY,eAAef,EAAG,MAAM,CAACE,YAAY,YAAYJ,EAAIkB,GAAIlB,EAAImB,UAAU,SAASC,EAAKC,GAAO,OAAOnB,EAAG,WAAW,CAACoB,IAAID,EAAMX,MAAM,CAAC,MAAQU,EAAKG,MAAM,UAAU,IAAIC,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOzB,EAAI0B,OAAON,EAAKO,KAAM,IAAI,IAAE,IACpgC,EACGC,EAAkB,GC2BtB,GACAD,KAAAA,KACAE,OACA,OACAV,SACA,CACA,CAAAI,MAAAA,OAAAI,KAAAA,WACA,CAAAJ,MAAAA,OAAAI,KAAAA,SACA,CAAAJ,MAAAA,OAAAI,KAAAA,QACA,CAAAJ,MAAAA,OAAAI,KAAAA,SACA,CAAAJ,MAAAA,OAAAI,KAAAA,WACA,CAAAJ,MAAAA,OAAAI,KAAAA,WAEAtB,SAAAA,CAAAA,EAEA,EACAyB,UACA,kBAEA,EACAC,QAAAA,CACAC,cACA,oCACA,MAGA,OAFA,yBACA,mBAAAL,KAAAA,UAGA,qBACAM,QAAAA,QACAC,aAAAA,EACAC,SAAAA,IAEA,YACAC,OAAAA,MACAC,IAAAA,UACAC,OAAAA,CACAC,OAAAA,KAAAA,OACAC,iBAEAC,MAAAC,IACA,oBAEA,iBACA,mBAAAf,KAAAA,UACA,sBACA,+BACA,IAEAgB,OAAAC,IACA,sBAEA,EACAjC,SAAAA,GACA,iCACA,IACA,4BACA,qBAEA,YADA,qCAGA,4BAEA,OAEA,YADA,gCAGA,6DAEA,gCAEA,MAEA,OADA,oBACA,mBAAAgB,KAAAA,UAGA,qBACAM,QAAAA,QACAC,aAAAA,EACAC,SAAAA,IAGA,YACAC,OAAAA,OACAC,IAAAA,gBACAR,KAAAA,CACAU,OAAAA,KAAAA,OACAC,cACAK,QAAAA,EACAC,gBAAAA,KAEAL,MAAAC,IACA,oBACA,oCAAAf,KAAAA,UACA,sBACA,oCAEA,2BACAgB,OAAAC,IACA,sBAEA,EACAlB,OAAAA,GACA,mBAAAC,QACA,ICrIkP,I,UCQ9OoB,GAAY,OACd,EACAhD,EACA6B,GACA,EACA,KACA,KACA,MAIF,EAAemB,EAAiB,O","sources":["webpack://rx/./src/views/My.vue","webpack://rx/src/views/My.vue","webpack://rx/./src/views/My.vue?4690","webpack://rx/./src/views/My.vue?333e"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"my\"},[(_vm.userInfo.userBg)?_c('div',{staticClass:\"my-bg\",style:({backgroundImage:`url('${_vm.userInfo.userBg}')`})},[_c('van-uploader',{staticClass:\"upload-box\",staticStyle:{\"width\":\"100%\",\"height\":\"200px\",\"color\":\"aqua\"},attrs:{\"after-read\":_vm.uploadBg}})],1):_vm._e(),_c('div',{staticClass:\"my-info\"},[_c('div',{staticClass:\"clearfix\"},[_c('div',{staticClass:\"my-img fl\"},[(_vm.userInfo.userBg)?_c('img',{staticClass:\"auto-img\",attrs:{\"src\":_vm.userInfo.userImg,\"alt\":\"\"}}):_vm._e()]),_c('div',{staticClass:\"my-info-box fl\"},[_c('div',{staticClass:\"user-name\"},[_vm._v(_vm._s(_vm.userInfo.nickName))]),_c('div',{staticClass:\"user-desc\"},[_vm._v(_vm._s(_vm.userInfo.desc == '' ? \"这个家伙很懒什么都没留下\" :_vm.userInfo.desc))])])])]),_c('div',{staticClass:\"list-box\"},_vm._l((_vm.listData),function(item,index){return _c('van-cell',{key:index,attrs:{\"title\":item.title,\"is-link\":\"\"},on:{\"click\":function($event){return _vm.goPage(item.name)}}})}),1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n      <div class=\"my\">\r\n            <div class=\"my-bg\" v-if=\"userInfo.userBg\" :style=\"{backgroundImage:`url('${userInfo.userBg}')`}\">\r\n                  <van-uploader class=\"upload-box\" :after-read=\"uploadBg\" style=\"width:100%;height:200px;color: aqua;\">\r\n            </van-uploader>\r\n                </div>\r\n            <div class=\"my-info\">\r\n                  <div class=\"clearfix\">\r\n                        <div class=\"my-img fl\">\r\n                             \r\n                            <!-- 用户头像 -->\r\n                              <img :src=\"userInfo.userImg\" v-if=\"userInfo.userBg\" alt=\"\" class=\"auto-img\" />\r\n                           \r\n                </div>\r\n                        <div class=\"my-info-box fl\">\r\n                              <div class=\"user-name\">{{ userInfo.nickName }}</div>\r\n                              <div class=\"user-desc\">{{ userInfo.desc == '' ? \"这个家伙很懒什么都没留下\" :userInfo.desc }}</div>\r\n                            </div>\r\n                      </div>\r\n                </div>\r\n            <div class=\"list-box\">                \r\n            <van-cell v-for=\"(item, index) in listData\" :key=\"index\" :title=\"item.title\" is-link\r\n                @click=\"goPage(item.name)\" />               \r\n        </div>\r\n          </div>\r\n\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    name: 'My',\r\n    data() {\r\n        return {\r\n            listData:\r\n                [\r\n                    { title: '个人资料', name: 'Account', },\r\n                    { title: '我的订单', name: 'Order', },\r\n                    { title: '我的收藏', name: 'Like', },\r\n                    { title: '我的足迹', name: 'Track', },\r\n                    { title: '地址管理', name: 'Address', },\r\n                    { title: '安全中心', name: 'Secure', },\r\n                ],\r\n            userInfo: {}\r\n        };\r\n    },\r\n    created() {\r\n        this.getUserInfo();\r\n        // this.$router.push({path:\"/My\"})\r\n    },\r\n    methods: {\r\n        getUserInfo() {\r\n            let tokenString = localStorage.getItem('token');\r\n            if (!tokenString) {\r\n                this.$toast(\"请先登录\");\r\n                this.$router.push({ name: \"Login\" });\r\n                return\r\n            }\r\n            this.$toast.loading({\r\n                message: \"加载中……\",\r\n                forbidClick: true,\r\n                duration: 0,\r\n            });\r\n            this.axios({\r\n                method: 'GET',\r\n                url: '/findMy',\r\n                params: {\r\n                    appkey: this.appkey,\r\n                    tokenString\r\n                }\r\n            }).then((result) => {\r\n                this.$toast.clear();\r\n                // console.log(result);\r\n                if (result.data.code == 700) {\r\n                    this.$router.push({ name: \"Login\" });\r\n                } else if (result.data.code == \"A001\") {\r\n                    this.userInfo = result.data.result[0];\r\n                }\r\n            })\r\n                .catch((err) => {\r\n                    this.$toast.clear();\r\n                });\r\n        },\r\n        uploadBg(file) {\r\n            let type = [\"gif\", \"png\", \"jpg\", \"jpeg\"];\r\n            let size = 1;\r\n            let filetype = file.file.type.split(\"/\")[1];\r\n            if (type.indexOf(filetype) === -1) {\r\n                this.$toast(`文件类型只支持${type.join(\",\")}`);\r\n                return;\r\n            }\r\n            let fileSize = file.file.size / 2048 / 2048;\r\n\r\n            if (fileSize > size) {\r\n                this.$toast(`文件允许最大不能超过${size}MB`);\r\n                return;\r\n            }\r\n            let base64 = file.content.replace(/^data:image\\/[A-Za-z]+;base64,/, '');\r\n\r\n            let tokenString = localStorage.getItem(\"token\");\r\n\r\n            if (!tokenString) {\r\n                this.$toast(\"请先登录\");\r\n                return this.$router.push({ name: \"Login\" });\r\n            }\r\n\r\n            this.$toast.loading({\r\n                message: \"加载中……\",\r\n                forbidClick: true,\r\n                duration: 0,\r\n            });\r\n\r\n            this.axios({\r\n                method: 'POST',\r\n                url: '/updateUserBg',\r\n                data: {\r\n                    appkey: this.appkey,\r\n                    tokenString,\r\n                    imgType: filetype,\r\n                    serverBase64Img: base64,\r\n                }\r\n            }).then((result) => {\r\n                this.$toast.clear();\r\n                if (result.data.code == 700) { this.$router.push({ name: \"Login\" }); }\r\n                else if (result.data.code == \"I001\") {\r\n                    this.userInfo.userBg = result.data.userBg;\r\n                }\r\n                this.$toast(result.data.msg)\r\n            }).catch((err) => {\r\n                this.$toast.clear();\r\n            });\r\n        },\r\n        goPage(name) {\r\n            this.$router.push({ name });\r\n        }\r\n    },\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.my {\r\n    .my-bg {\r\n        height: 180px;\r\n        background-color: #fff;\r\n        background-position: center center;\r\n        background-repeat: no-repeat;\r\n        background-size: cover;\r\n        position: relative;\r\n    }\r\n\r\n    .upload-box {\r\n        opacity: 0;\r\n        position: absoulte;\r\n        width: 100%;\r\n        // height: 100%;\r\n        left: 0;\r\n        top: 0;\r\n\r\n        .van-uploader_wrapper {\r\n            height: 100%;\r\n        }\r\n\r\n        .van-uploader_upload {\r\n            width: 100%;\r\n            height: 100%;\r\n            margin: 0;\r\n        }\r\n    }\r\n\r\n    .my-info {\r\n        margin: 0 10px;\r\n        position: relative;\r\n        top: -40px;\r\n        padding: 10px 10px 0 10px;\r\n        border-top-left-radius: 8px;\r\n        border-top-right-radius: 8px;\r\n        background-image: linear-gradient(to bottom rgba(255, 255, 255, .65)0, rgba(255, 255, 255, 1)90px, #fff 90px#fff 100%);\r\n    }\r\n\r\n    .my-img {\r\n        width: 70px;\r\n        height: 70px;\r\n        border-radius: 50%;\r\n        overflow: hidden;\r\n        background-color: #ddd;\r\n        margin-right: 20px;\r\n\r\n        img {\r\n            width: 70px;\r\n            height: 70px;\r\n        }\r\n    }\r\n\r\n    .my-info-box {\r\n        // width: calc(\"~100% - 90px\");\r\n        height: 70px;\r\n    }\r\n\r\n    .user-name {\r\n        color: aqua;\r\n        height: 30px;\r\n        font-weight: bold;\r\n    }\r\n\r\n    .user-desc {\r\n        font-size: 14px;\r\n        color: #999;\r\n        height: 40px;\r\n        display: -webkit-box;\r\n        -webkit-line-clamp: 2; //\r\n        -webkit-box-orient: vertical;\r\n        overflow: hidden;\r\n    }\r\n\r\n    // .list-box{\r\n    //     margin-top: 2px;\r\n    // }\r\n    /deep/.van-cell {\r\n        border-bottom: 1px solid #F5F6F7;\r\n        padding: 15px 0;\r\n\r\n        &:last-child {\r\n            border-bottom: none;\r\n        }\r\n\r\n        &:active {\r\n            background-color: transparent;\r\n        }\r\n\r\n        span {\r\n            color: #646566;\r\n        }\r\n    }\r\n\r\n\r\n}\r\n</style>","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./My.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./My.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./My.vue?vue&type=template&id=0ae043c8&\"\nimport script from \"./My.vue?vue&type=script&lang=js&\"\nexport * from \"./My.vue?vue&type=script&lang=js&\"\nimport style0 from \"./My.vue?vue&type=style&index=0&id=0ae043c8&prod&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","userInfo","userBg","style","backgroundImage","staticStyle","attrs","uploadBg","_e","userImg","_v","_s","nickName","desc","_l","listData","item","index","key","title","on","$event","goPage","name","staticRenderFns","data","created","methods","getUserInfo","message","forbidClick","duration","method","url","params","appkey","tokenString","then","result","catch","err","imgType","serverBase64Img","component"],"sourceRoot":""}